# Chapter 5. 局部图像特征

## 1. 图像梯度

图像梯度定义:

$\Delta I=(\delta I/\delta x, \delta I/ \delta y)^T$

- 有限差分，对于图像梯度，最简单的方法就是对于$\delta I/ \delta x \sim I_{i+1,j}-I_{i,j}$

  - 但是这对于噪声敏感，导致噪声的地方，梯度过高。
  - 一般先做平滑，然后再做有限差分
  - 最常见的噪声模型为“加性平稳高斯噪声模型”，由于噪声是独立加在每个像素上，对于由数十个像素导致的角点，噪声为局部事件，那么其应该能够对于这噪声鲁棒。
- 差分高斯滤波

  - $K_{(\delta /\delta x)}** (S**I)=(K_{(\delta /\delta x)}**S)**I=(\delta S/ \delta x) **I$
  - 那么也就对平滑函数的差分，在做卷积对应图像。如果平滑函数为高斯函数，那么就为差分高斯函数。

## 2. 边缘梯度表征

- 算法：基于梯度的边缘检测子

  ```
  * 形成一个图像梯度的估计
  * 从这个估计中获取计算梯度幅值
  * while 具有超过阈值的梯度复制的像素点还未被访问
    1. 查找垂直于梯度防线的像素点，如果具有局部最大幅值，做标记访问
    2. while 是，以当前点作为扩展链起点：
       1. 采用垂直于梯度方向的方向，预测下一点
       2. 查找沿着改梯度方向是否为局部最大值
       3. 验证该梯度幅值是否足够大
       4. 标记该点和其近邻以表示访问过
    3. 记录下一点，以作为当前点
  ```

## 3. 寻找角点与建立近邻

角点具有局部性，适合图像匹配。

- 角点应该具有很大的梯度幅值
- 在很小的近邻内，梯度方向应该变化尖锐

那么在给定的窗口内，$H=\sum_{win}\{(\Delta I)(\Delta)^T\}$

- Harris 角点检测，寻找局部最大值：
  $det(H)-k(trace(H)/2)^2$

  - k是其中的常数。
  - 检测特征值行列式是否大于其平均值的平方，如果其值很大，意味着该特征值都很大。
- 算法：采用角点检测自己算模式元素的位置、半径、和方向

  ```
  给定某固定尺度参数k
  对图像I采用某角点检测子
  初始化一系列的图像块（windows）
  将每一个查找得到的角点：
  	记角点的位置为(x_c,y_c)
  	计算位于（x_c,y_c)在图像块的半径r
  ```
  $r(x_c,y_c)=argmax_{\sigma} \delta^2_{\sigma}I(x_c,y_c)$

  ```
          其中\delta^2_\sigma(x_c,y_c)由多个\sigma计算并对这一系列值进行插值，最大化得到所求半径r
  	计算梯度方向只放度H(\theta),其区域为中心在(x_c,y_c)，半径为kr的区域
  	计算图像块\theta_p的方向
  ```
  $\theta_p=argmax_{\theta}H(\theta)$

  ```
          如果有多个\theta满足该式，则对每个满足要求的\theta复制一个新的图像块
  将(x_c,y_c,r,\theta_p)附加到图像块列表中
  ```
